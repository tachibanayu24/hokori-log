{"dev/Obsidian-vaultの一部のディレクトリだけをQuartzで公開する":{"slug":"dev/Obsidian-vaultの一部のディレクトリだけをQuartzで公開する","filePath":"dev/Obsidian vaultの一部のディレクトリだけをQuartzで公開する.md","title":"Obsidian vaultの一部のディレクトリだけをQuartzで公開する","links":[],"tags":["Obsidian"],"content":"何回目かわからないけどブログを作りました。\n試したい技術が現れるたびにブログを作っている気がしますが、今回はちゃんと更新していけるように頑張ります。\nこのブログは、Obsidianのvault（保管庫 ローカルのディレクトリ）の一部のディレクトリをブログ記事として切り出してSSGで記事化し公開する構成になっているので、その説明をします。\nQuartz自体の説明はここではしません。\nこの構成のメリット\npushごとに公開\nObsidianのノートを更新してpushするたびにデプロイjobが実行されるので公開が楽です。\nプライベートなvaultと同一リポジトリ内で独立\n通常、QuartzなどのSSGでブログを作るときは、SSGリポジトリの内部にObsidianのvaultを配置することになると思います。\nその場合、プライベートなvaultとは独立することになりますが、管理が面倒ですし、LLMの恩恵を受けながら記事を書きたい場合は同一のリポジトリで管理して、同じ場所でドキュメントをindex化して活用したいです。\nそういったことができるようになります。\n構成\nリポジトリは2つ登場します。\n\nobsidian-vault\n\nプライベートなObsidian vault\n_published ディレクトリ内のドキュメントのみpushするためのリポジトリ\n\n\nobsidian-blog\n\nブログのSSGやUIなどを管理する（つまりこのブログの本体）\nソースコードはこちら\n\n\n\nアプローチは、obsidian-vaultの _published ディレクトリ内に変更があったときにGitHub Actionsでeventをdispatchして、obsidian-blog側のGitHub Actionsではobsidian-vaultをcloneしてきてSSGで記事を生成して公開するというものです。\nちなみに、ローカルでは obsidian-blog の content に obsidian-vault のシンボリックリンクを貼って、obsidian-blogでcontentを .gitignore すればローカルでも問題なくプレビューできます。\nsequenceDiagram\n    participant OV as obsidian-vault\n    participant GA1 as GitHub Actions\n    participant GB as obsidian-blog\n    participant GA2 as GitHub Actions\n    participant GH as GitHub Pages\n\n    OV-&gt;&gt;GA1: _published/に差分あり\n    GA1-&gt;&gt;GB: vault-updated event\n    GB-&gt;&gt;GA2: triggered\n    GA2-&gt;&gt;OV: クローン\n    GA2-&gt;&gt;GA2: Quartz 4でビルド\n    GA2-&gt;&gt;GH: デプロイ\n\nDeploy用yml\nこれで _published に差分があったときに obsidian-blog のGAが受け取れるeventをdispatchします。\nDISPATCH_TOKEN は、obsidian-blogの contents:read,write 権限を持つ personal access token(PAT)です。\nobsidian-vault/.github/workflows/deploy.ymlname: Trigger Blog Deploy on Published Changes\n \non:\n  push:\n    branches:\n      - main\n    paths:\n      - &#039;_published/**/*.md&#039;\n \njobs:\n  dispatch:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Trigger deployment in obsidian-blog repo\n        uses: peter-evans/repository-dispatch@v3\n        with:\n          token: ${{ secrets.DISPATCH_TOKEN }}\n          repository: tachibanayu24/obsidian-blog\n          event-type: vault-updated\nこれで obsidian-vault から受け取ったeventをトリガーにしてデプロイを実行します。 obsidian-blog でmainブランチにpushしたときにも実行します。\nVAULT_ACCESS_TOKEN は、obsidian-vaultの contents:read 権限を持つ personal access token(PAT)です。\nobsidian-blog/.github/workflows/deploy.ymlname: Deploy Blog\n \non:\n  push:\n    branches:\n      - main\n \n  repository_dispatch:\n    types: [vault-updated] # obsidian-vaultの `_published` が更新されたらdispatchされる\n \npermissions:\n  contents: write\n \njobs:\n  build_and_deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout obsidian-blog Repo\n        uses: actions/checkout@v4\n        with:\n          path: obsidian-blog\n \n      - name: Checkout obsidian-vault Repo (to temp location)\n        uses: actions/checkout@v4\n        with:\n          repository: tachibanayu24/obsidian-vault\n          path: vault-temp\n          token: ${{ secrets.VAULT_ACCESS_TOKEN }}\n \n      - name: Prepare content directory\n        run: mkdir -p obsidian-blog/content\n \n      - name: Copy published content\n        run: |\n          if [ -d &quot;vault-temp/_published&quot; ] &amp;&amp; [ &quot;$(ls -A vault-temp/_published)&quot; ]; then\n            cp -r vault-temp/_published/* obsidian-blog/content/\n          else\n            echo &quot;Warning: vault-temp/_published directory is empty or does not exist.&quot;\n          fi\n \n      # attachmentsは通常 `_published` には配置しないので、画像など正しく表示するためにこれもコピーする\n      - name: Copy attachments to content root\n        run: |\n          if [ -d &quot;vault-temp/_config/attachment&quot; ] &amp;&amp; [ &quot;$(ls -A vault-temp/_config/attachment)&quot; ]; then\n            cp -r vault-temp/_config/attachment/* obsidian-blog/content/\n          else\n            echo &quot;Info: vault-temp/_config/attachment directory is empty or does not exist.&quot;\n          fi\n \n \n      - name: Setup Node, Install, Build\n        working-directory: obsidian-blog\n        env:\n          NODE_ENV: production\n        run: |\n          npm ci\n          npx quartz build\n \n      - name: Deploy to GitHub Pages\n        uses: peaceiris/actions-gh-pages@v3\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n          publish_dir: ./obsidian-blog/public\n          cname: blog.tachibanayu24.com\nおわり\nこれで単一vault内でプライベートな領域と公開用の領域で分けることができました。"},"finance/2025-04-06-米国株の現在地の確認":{"slug":"finance/2025-04-06-米国株の現在地の確認","filePath":"finance/2025-04-06 米国株の現在地の確認.md","title":"2025-04-06 米国株の現在地の確認","links":[],"tags":["株式"],"content":"値動きが激しいので現在の米国株（S&amp;P500）の状況を確認します。\nあんまりこの手の話題で自分の意見を書くのもどうかなと思うので、客観的な事実だけをまとめます。（市場の予想は一切しません）\n最近の主な出来事\nトランプ氏、相互関税を発表　最大50％で日本は24％ - BBCニュース\n\n\n                  \n                  AIによる要約 \n                  \n                \n\nトランプ米大統領が全輸入品への新関税計画を発表。10%基本税に加え、「最悪の違反者」に追加関税。日本には24%が課される。中国やEUにも高関税。「経済的独立宣言」とし、世界経済への影響が懸念されている。\n\n\n中国が報復関税を発表、米株式市場はパンデミック以来の大幅安に - BBCニュース\n\n\n                  \n                  AIによる要約 \n                  \n                \n\n中国が米国の関税に対抗し、全米輸入品へ34%の報復関税を発表。これを受け欧米株価は急落、米主要指数は5%超下落しパンデミック以来最悪の週となった。貿易戦争激化と世界経済への悪影響が懸念される。\n\n\nチャート\nS&amp;P500の直近高値は6147USD、現在の株価は5074USDです。\n2/19の高値から1ヶ月半ほどしか経過していませんが、17.5%ほど下がっています。\n調整局面の目安は10%、弱気相場の目安は20%なので、今は調整局面です。\nちなみにナスダックとラッセル2000はすでに弱気相場入りしています。\n月足では3月に -5.75% と大きく下落しましたが、現時点で4月もすでに -9.58% 下げています。\n\n日足では200日移動平均線で弾かれたあとに、2日連続で出来高を伴って窓を開けて大きく下落しています。\n\n金曜日は広範囲の銘柄が売られたのでヒートマップは真っ赤になっています。\n\nセンチメント\n恐怖指数(VIX)\nVIXはこの急落を受けて45.3まで急騰しました。\n直近でVIXが40を超えたときのイベントは以下のとおりです。\n\n2024年8月\n\n日経平均株価4451円安　下げ幅ブラックマンデー超え最大 - 日本経済新聞\n\n\n2020年3月〜4月\n\nコロナウイルスの世界的流行\n\n\n\nつまり、一瞬のパニック売があった2024年8月を除けばコロナウイルス流行時以来の水準です。\n\n\n                  \n                  Figure\n                  \n                \n\n\nFINANCIAL VISUALIZATIONSより\n\n\nFear &amp; Greed Index\n現在値は 4 で Extreme Fearです。\n\nプットコールレシオ\nプットオプションとコールオプションの比で表されるプットコールレシオは現在 1.07です。（IBD）\n1を超えているので、弱気が優勢になってきているということが言えます。\n来週のイベント\n\n4/9\n\nデルタ航空（DAL）決算\n\n\n4/10\n\n米国 消費者物価指数（CPI・コアCPI）\n米国 新規失業保険申請件数\n\n\n4/11\n\n米国 生産者物価指数（PPI）\n米国 ミシガン大学消費者信頼感指数\nJPモルガン（JPM）決算\nウェルズ・ファーゴ（WFC）決算\n\n\n\n再来週（4/14~）は小売売上高、鉱工業生産指数やゴールドマン・サックス、バンク・オブ・アメリカ、ユナイテッドヘルス、ネットフリックスなどの決算があります。\n各国の米国関税に対するリアクションもどんどん出てくるかもしれません。"},"index":{"slug":"index","filePath":"index.md","title":"TOP","links":[],"tags":[],"content":"たちばなゆうとのブログです。\n主にソフトウェア、LLM、スタートアップビジネス、ファイナンスなどの話題の記事を書くつもりです。"}}